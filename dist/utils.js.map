{"version":3,"sources":["../src/utils.js"],"names":["appEvents","hostname","window","location","postgRestHost","influxHost","post","url","line","Promise","resolve","reject","xhr","XMLHttpRequest","open","onreadystatechange","handleResponse","setRequestHeader","onerror","e","send","readyState","status","responseText","remove","statusText","get","res","JSON","parse","update","alert","type","title","msg","emit","showModal","html","data","src","modalClass","model","showLargeModal","spaceCheck","str","length","slice","successCallBack","modalId","successMsg","ctrl","$","trigger","refresh","failCallBack","failMsg","getRestructuredProduct","rawCols","rows","cols","reduce","arr","c","col","text","toLowerCase","push","i","row","serise","k","ingredient","findProductById","products","key","filter","product","product_id","getDimension","map","copy","stringify","obj","hasObjectChanged","oldObj","newObj","getRestructuredData"],"mappings":"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","file":"utils.js","sourcesContent":["import { appEvents } from 'app/core/core'\n\nconst hostname = window.location.hostname\nexport const postgRestHost = 'http://' + hostname + ':5436/'\nexport const influxHost = 'http://' + hostname + ':8086/'\n\nexport const post = (url, line) => {\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest()\n      xhr.open('POST', url)\n      xhr.onreadystatechange = handleResponse\n      xhr.setRequestHeader(\"Accept\", \"application/json\");\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onerror = e => reject(e)\n      xhr.send(line)\n  \n      function handleResponse () {\n        if (xhr.readyState === 4) {\n          if (xhr.status === 200) {\n            // console.log('200');\n            resolve(xhr.responseText)\n          } else if (xhr.status === 204) {\n            // console.log('204');\n            resolve(xhr.responseText)\n          } else if (xhr.status === 201) {\n            resolve(xhr.responseText)\n          } else {\n            reject(xhr.responseText)\n          }\n        }\n      }\n    })\n  }\n\nexport const remove = (url) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('DELETE', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.onerror = e => reject(e)\n    xhr.send()\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          resolve(xhr.responseText)\n        } else {\n          reject(this.statusText)\n        }\n      }\n    }\n  })\n}\n\nexport const get = url => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('GET', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.onerror = e => reject(e)\n    xhr.send()\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          var res = JSON.parse(xhr.responseText)\n          resolve(res)\n        } else {\n          reject(this.statusText)\n        }\n      }\n    }\n  })\n}\n\nexport const update = (url, line) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('PATCH', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.setRequestHeader(\"Accept\", \"application/json\");\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");      \n    xhr.onerror = e => reject(e)\n    xhr.send(line)\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 201) {\n          resolve(xhr.responseText)\n        } else {\n          reject(xhr.responseText)\n        }\n      }\n    }\n  })\n}\n\nexport const alert = (type, title, msg) => {\n  appEvents.emit('alert-' + type, [title, msg])\n}\n\nexport const showModal = (html, data) => {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-products-crud-table-panel/partials/' + html,\n    modalClass: 'confirm-modal',\n    model: data\n  })\n}\n\nexport const showLargeModal = (html, data) => {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-products-crud-table-panel/partials/' + html,\n    modalClass: 'extra-large',\n    model: data\n  })\n}\n\nexport const spaceCheck = str => {\n  if (str[str.length - 1] === ' ') {\n    str = str.slice(0, -1)\n    return spaceCheck(str)\n  }\n  return str\n}\n\nexport const successCallBack = (modalId, successMsg, ctrl) => {\n  return () => {\n    $(`#${modalId}`).trigger('click')\n    alert('success', 'Success', successMsg)\n    ctrl.refresh()\n  }\n}\n\nexport const failCallBack = (modalId, failMsg) => {\n  return () => {\n    $(`#${modalId}`).trigger('click')\n    alert('error', 'Error', failMsg)\n  }\n}\n\nexport const getRestructuredProduct = (rawCols, rows) => {\n  let data = []\n  let cols = rawCols.reduce((arr, c) => {\n    const col = c.text.toLowerCase()\n    arr.push(col)\n    return arr\n  }, [])\n  for (let i = 0; i < rows.length; i++) {\n    const row = rows[i];\n    let serise = {}\n    for (let k = 0; k < cols.length; k++) {\n        const col = cols[k];\n        serise[col] = row[k]\n    }\n    serise.ingredient = JSON.parse(serise.ingredient)\n    data.push(serise)\n  }\n  return data\n}\n\nexport const findProductById = (products, key) => {\n  return products.filter(product => product.product_id === key)\n}\n\nexport const getDimension = cols => {\n  return cols.map(col => col.text)\n}\n\nexport const copy = obj => {\n  return JSON.parse(JSON.stringify(obj)) \n}\n\nexport const hasObjectChanged = (oldObj, newObj) => {\n  return JSON.stringify(oldObj) !== JSON.stringify(newObj)\n}\n\nexport const getRestructuredData = (rawCols, rows) => {\n  let data = []\n  let cols = rawCols.reduce((arr, c) => {\n    const col = c.text.toLowerCase()\n    arr.push(col)\n    return arr\n  }, [])\n  for (let i = 0; i < rows.length; i++) {\n    const row = rows[i];\n    let serise = {}\n    for (let k = 0; k < cols.length; k++) {\n        const col = cols[k];\n        serise[col] = row[k]\n    }\n    data.push(serise)\n  }\n  return data\n}"]}
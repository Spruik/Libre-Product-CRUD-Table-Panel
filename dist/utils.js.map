{"version":3,"sources":["../src/utils.js"],"names":["appEvents","hostname","window","location","postgRestHost","influxHost","post","url","line","Promise","resolve","reject","xhr","XMLHttpRequest","open","onreadystatechange","handleResponse","setRequestHeader","onerror","e","send","readyState","status","responseText","remove","statusText","get","res","JSON","parse","update","alert","type","title","msg","emit","showModal","html","data","src","modalClass","model","showLargeModal","spaceCheck","str","length","slice","successCallBack","modalId","successMsg","ctrl","$","trigger","refresh","failCallBack","failMsg","getRestructuredProduct","rawCols","rows","cols","reduce","arr","c","col","text","toLowerCase","push","i","row","serise","k","ingredient","findProductById","products","key","filter","product","id","findProductByDesc","product_desc","getDimension","map","copy","stringify","obj","hasObjectChanged","oldObj","newObj","getRestructuredData"],"mappings":"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","file":"utils.js","sourcesContent":["import { appEvents } from 'app/core/core'\r\n\r\nconst hostname = window.location.hostname\r\nexport const postgRestHost = 'http://' + hostname + ':5436/'\r\nexport const influxHost = 'http://' + hostname + ':8086/'\r\n\r\nexport const post = (url, line) => {\r\n  return new Promise((resolve, reject) => {\r\n    var xhr = new XMLHttpRequest()\r\n    xhr.open('POST', url)\r\n    xhr.onreadystatechange = handleResponse\r\n    xhr.setRequestHeader('Accept', 'application/json')\r\n    xhr.setRequestHeader('Content-Type', 'application/json')\r\n    xhr.onerror = e => reject(e)\r\n    xhr.send(line)\r\n\r\n    function handleResponse () {\r\n      if (xhr.readyState === 4) {\r\n        if (xhr.status === 200) {\r\n          // console.log('200');\r\n          resolve(xhr.responseText)\r\n        } else if (xhr.status === 204) {\r\n          // console.log('204');\r\n          resolve(xhr.responseText)\r\n        } else if (xhr.status === 201) {\r\n          resolve(xhr.responseText)\r\n        } else {\r\n          reject(xhr.responseText)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const remove = (url) => {\r\n  return new Promise((resolve, reject) => {\r\n    var xhr = new XMLHttpRequest()\r\n    xhr.open('DELETE', url)\r\n    xhr.onreadystatechange = handleResponse\r\n    xhr.onerror = e => reject(e)\r\n    xhr.send()\r\n\r\n    function handleResponse () {\r\n      if (xhr.readyState === 4) {\r\n        if (xhr.status === 200) {\r\n          // console.log('200');\r\n          resolve(xhr.responseText)\r\n        } else if (xhr.status === 204) {\r\n          // console.log('204');\r\n          resolve(xhr.responseText)\r\n        } else {\r\n          reject(this.statusText)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const get = url => {\r\n  return new Promise((resolve, reject) => {\r\n    var xhr = new XMLHttpRequest()\r\n    xhr.open('GET', url)\r\n    xhr.onreadystatechange = handleResponse\r\n    xhr.onerror = e => reject(e)\r\n    xhr.send()\r\n\r\n    function handleResponse () {\r\n      if (xhr.readyState === 4) {\r\n        if (xhr.status === 200) {\r\n          var res = JSON.parse(xhr.responseText)\r\n          resolve(res)\r\n        } else {\r\n          reject(this.statusText)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const update = (url, line) => {\r\n  return new Promise((resolve, reject) => {\r\n    var xhr = new XMLHttpRequest()\r\n    xhr.open('PATCH', url)\r\n    xhr.onreadystatechange = handleResponse\r\n    xhr.setRequestHeader('Accept', 'application/json')\r\n    xhr.setRequestHeader('Content-Type', 'application/json')\r\n    xhr.onerror = e => reject(e)\r\n    xhr.send(line)\r\n\r\n    function handleResponse () {\r\n      if (xhr.readyState === 4) {\r\n        if (xhr.status === 200) {\r\n          // console.log('200');\r\n          resolve(xhr.responseText)\r\n        } else if (xhr.status === 204) {\r\n          // console.log('204');\r\n          resolve(xhr.responseText)\r\n        } else if (xhr.status === 201) {\r\n          resolve(xhr.responseText)\r\n        } else {\r\n          reject(xhr.responseText)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const alert = (type, title, msg) => {\r\n  appEvents.emit('alert-' + type, [title, msg])\r\n}\r\n\r\nexport const showModal = (html, data) => {\r\n  appEvents.emit('show-modal', {\r\n    src: 'public/plugins/libre-product-crud-table-panel/partials/' + html,\r\n    modalClass: 'confirm-modal',\r\n    model: data\r\n  })\r\n}\r\n\r\nexport const showLargeModal = (html, data) => {\r\n  appEvents.emit('show-modal', {\r\n    src: 'public/plugins/libre-product-crud-table-panel/partials/' + html,\r\n    modalClass: 'extra-large',\r\n    model: data\r\n  })\r\n}\r\n\r\nexport const spaceCheck = str => {\r\n  if (str[str.length - 1] === ' ') {\r\n    str = str.slice(0, -1)\r\n    return spaceCheck(str)\r\n  }\r\n  return str\r\n}\r\n\r\nexport const successCallBack = (modalId, successMsg, ctrl) => {\r\n  return () => {\r\n    $(`#${modalId}`).trigger('click')\r\n    alert('success', 'Success', successMsg)\r\n    ctrl.refresh()\r\n  }\r\n}\r\n\r\nexport const failCallBack = (modalId, failMsg) => {\r\n  return () => {\r\n    $(`#${modalId}`).trigger('click')\r\n    alert('error', 'Error', failMsg)\r\n  }\r\n}\r\n\r\nexport const getRestructuredProduct = (rawCols, rows) => {\r\n  const data = []\r\n  const cols = rawCols.reduce((arr, c) => {\r\n    const col = c.text.toLowerCase()\r\n    arr.push(col)\r\n    return arr\r\n  }, [])\r\n  for (let i = 0; i < rows.length; i++) {\r\n    const row = rows[i]\r\n    const serise = {}\r\n    for (let k = 0; k < cols.length; k++) {\r\n      const col = cols[k]\r\n      serise[col] = row[k]\r\n    }\r\n    serise.ingredient = JSON.parse(serise.ingredient)\r\n    data.push(serise)\r\n  }\r\n  return data\r\n}\r\n\r\nexport const findProductById = (products, key) => {\r\n  return products.filter(product => product.id === key)\r\n}\r\n\r\nexport const findProductByDesc = (products, key) => {\r\n  return products.filter(product => product.product_desc === key)\r\n}\r\n\r\nexport const getDimension = cols => {\r\n  return cols.map(col => col.text)\r\n}\r\n\r\nexport const copy = obj => {\r\n  return JSON.parse(JSON.stringify(obj))\r\n}\r\n\r\nexport const hasObjectChanged = (oldObj, newObj) => {\r\n  return JSON.stringify(oldObj) !== JSON.stringify(newObj)\r\n}\r\n\r\nexport const getRestructuredData = (rawCols, rows) => {\r\n  const data = []\r\n  const cols = rawCols.reduce((arr, c) => {\r\n    const col = c.text.toLowerCase()\r\n    arr.push(col)\r\n    return arr\r\n  }, [])\r\n  for (let i = 0; i < rows.length; i++) {\r\n    const row = rows[i]\r\n    const serise = {}\r\n    for (let k = 0; k < cols.length; k++) {\r\n      const col = cols[k]\r\n      serise[col] = row[k]\r\n    }\r\n    data.push(serise)\r\n  }\r\n  return data\r\n}\r\n"]}